<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="Products.GEMI">
    <body>
        <div metal:fill-slot="content-core">

        <div metal:define-macro="text-field-view"
             id="parent-fieldname-text" class="stx"
             tal:define="has_text exists:context/aq_explicit/getText;
                         text python:has_text and here.getText() or ''"
             tal:condition="text">
            <div metal:define-slot="inside" tal:replace="structure text">The body</div>
        </div>

        <div class="bibfolder-recent-collections">
            <div class="results-container"
                tal:define="
                batch python: view.getResults();
                results python: view.gutil.groupBibItemsByYears(batch);
                ">
                <!-- grouping by years -->
                <div tal:condition="batch">
                    <metal:block tal:condition="results" tal:define="rkeys results/keys; dummy python:rkeys.sort(); dummy python:rkeys.reverse()">
                        <ul class="bibfolder-items home-publications">
                            <metal:block tal:repeat="year rkeys">
                                <metal:block 
                                    tal:condition="python: year.lower() and (year.lower() == 'in press' or float(year) > 1900)"
                                    tal:define="items python: results[year]">
                                        <metal:block
                                            tal:repeat="result items"
                                            tal:define="formatter nocall:context/@@bibfolderlistitemformatter">
                                            <tal:item tal:replace="structure python:formatter(result)" />
                                        </metal:block>

                                </metal:block>
                            </metal:block>
                        </ul>
                    </metal:block>
                </div>

            </div>
        </div>
        </div>
    </body>
</html>